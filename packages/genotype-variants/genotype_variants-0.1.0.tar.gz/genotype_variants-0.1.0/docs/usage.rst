=====
Usage
=====

Currently this module only supports genotyping and merging small variants (SNV and INDELS).

For this we have the following command line submodule called **small_variants**. 

Which have the following sub-commands:

* `generate`_: To run GetBaseCountMultiSample on given BAM files
* `merge`_: To merge MAF format files w.r.t counts generated from the `generate` command.
* `all`_: This will run both of the sub-commands above `generate` and `merge` togather.

generate
********

To use `small_variants generate` via command line here are the options::

    help: 
    ------

    > genotype_variants small_variants generate --help
    Usage: genotype_variants small_variants generate [OPTIONS]

    Command that helps to generate genotyped MAF, the output file will be
    labelled with  patient identifier as prefix

    Options:
    -i, --input-maf PATH            Full path to small variants input file in
                                    MAF format  [required]
    -r, --reference-fasta PATH      Full path to reference file in FASTA format
                                    [required]
    -p, --patient-id TEXT           Alphanumeric string indicating patient
                                    identifier  [required]
    -b, --standard-bam PATH         Full path to standard bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -d, --duplex-bam PATH           Full path to duplex bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -s, --simplex-bam PATH          Full path to simplex bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -g, --gbcms-path PATH           Full path to GetBaseCountMultiSample
                                    executable with fragment support  [required]
    -fd, --filter-duplicate INTEGER
                                    Filter duplicate parameter for
                                    GetBaseCountMultiSample
    -fc, --fragment-count INTEGER   Fragment Count parameter for
                                    GetBaseCountMultiSample
    -mapq, --mapping-quality INTEGER
                                    Mapping quality for GetBaseCountMultiSample
    -t, --threads INTEGER           Number of threads to use for
                                    GetBaseCountMultiSample
    -v, --verbosity LVL             Either CRITICAL, ERROR, WARNING, INFO or
                                    DEBUG
    --help                          Show this message and exit.


.. code-block:: console 
    
    genotype_variants small_variants generate \
    -i /path/to/input_maf \
    -r /path/to/reference_fasta \
    -g /path/to/GetBaseCountsMultiSample \
    -p patient_id \
    -b standard_bam \
    -d duplex_bam \
    -s simplex_bam 

merge
******

To use `small_variants merge` via command line here are the options::

    help: 
    ------
    > genotype_variants small_variants merge --help
    Usage: genotype_variants small_variants merge [OPTIONS]

    Given original input MAF used as an input for GBCMS along with  GBCMS
    generated output MAF for standard_bam, duplex_bam or simplex bam,  Merge
    them into a single output MAF format.  If both duplex_bam and simplex_bam
    based MAF are provided the program will generate merged genotypes as well.
    The output file will be based on the give alphanumeric patient identifier
    as suffix.

    Options:
    -i, --input-maf PATH            Full path to small variants input file in
                                    MAF format used for input to GBCMS for
                                    generating genotypes
    -std, --input-standard-maf PATH
                                    Full path to small variants input file in
                                    MAF format generated by GBCMS for
                                    standard_bam
    -d, --input-duplex-maf PATH     Full path to small variants input file in
                                    MAF format generated by GBCMS for duplex_bam
    -s, --input-simplex-maf PATH    Full path to small variants input file in
                                    MAF format generated by GBCMS for
                                    simplex_bam
    -p, --patient-id TEXT           Alphanumeric string indicating patient
                                    identifier  [required]
    -v, --verbosity LVL             Either CRITICAL, ERROR, WARNING, INFO or
                                    DEBUG
    --help                          Show this message and exit.


.. code-block:: console 
    
    genotype_variants small_variants merge \
    -i /path/to/input_maf \
    -std /path/to/standard_bam_genotyped_maf \
    -d /path/to/duplex_bam_genotyped_maf \
    -s /path/to/simplex_bam_genotyped_maf \
    -p patient_id \


all
****

To use `small_variants all` via command line here are the options::

    help: 
    ------

    > genotype_variants small_variants all --help
    Usage: genotype_variants small_variants all [OPTIONS]

    Command that helps to generate genotyped MAF and merge the genotyped MAF.
    the output file will be labelled with patient identifier as prefix

    Options:
    -i, --input-maf PATH            Full path to small variants input file in
                                    MAF format  [required]
    -r, --reference-fasta PATH      Full path to reference file in FASTA format
                                    [required]
    -p, --patient-id TEXT           Alphanumeric string indicating patient
                                    identifier  [required]
    -b, --standard-bam PATH         Full path to standard bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -d, --duplex-bam PATH           Full path to duplex bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -s, --simplex-bam PATH          Full path to simplex bam file, Note: This
                                    option assumes that the .bai file is present
                                    at same location as the bam file
    -g, --gbcms-path PATH           Full path to GetBaseCountMultiSample
                                    executable with fragment support  [required]
    -fd, --filter-duplicate INTEGER
                                    Filter duplicate parameter for
                                    GetBaseCountMultiSample
    -fc, --fragment-count INTEGER   Fragment Count parameter for
                                    GetBaseCountMultiSample
    -mapq, --mapping-quality INTEGER
                                    Mapping quality for GetBaseCountMultiSample
    -t, --threads INTEGER           Number of threads to use for
                                    GetBaseCountMultiSample
    -v, --verbosity LVL             Either CRITICAL, ERROR, WARNING, INFO or
                                    DEBUG
    --help                          Show this message and exit.


.. code-block:: console 
    
    genotype_variants small_variants all \
    -i /path/to/input_maf \
    -r /path/to/reference_fasta \
    -g /path/to/GetBaseCountsMultiSample \
    -p patient_id \
    -b standard_bam \
    -d duplex_bam \
    -s simplex_bam 

To use genotype_variants in a project::

    import genotype_variants
