(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){t.exports=n(30)},19:function(t,e,n){},22:function(t,e,n){},3:function(t,e,n){"use strict";(function(t){n.d(e,"c",function(){return o}),n.d(e,"a",function(){return l}),n.d(e,"b",function(){return d});var r=n(1),a=n.n(r),i=n(2),c=12;function o(){return s.apply(this,arguments)}function s(){return(s=Object(i.a)(a.a.mark(function e(){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.location.hash.substring(1,window.location.hash.length-1),r=t.from(n,"base64"),e.next=5,window.crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function l(t,e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(a.a.mark(function e(n,r){var i,o,s,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.from(r,"base64"),o=i.subarray(0,c),s=i.subarray(c),e.t0=t,e.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},n,s);case 6:return e.t1=e.sent,l=e.t0.from.call(e.t0,e.t1).toString("utf-8"),e.abrupt("return",l);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d(t,e){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(a.a.mark(function t(e,n){var r,i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=window.crypto.getRandomValues(new Uint8Array(c)),t.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,(new TextEncoder).encode(n));case 3:return i=t.sent,o=m(r,i),s=h(o),t.abrupt("return",s);case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}function m(t,e){var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer}function h(t){for(var e=new Uint8Array(t),n="",r=e.byteLength,a=0;a<r;a++)n+=String.fromCharCode(e[a]);return window.btoa(n)}}).call(this,n(25).Buffer)},30:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(5),c=n.n(i),o=(n(19),n(1)),s=n.n(o),l=n(2),u=n(6),d=n(7),p=n(12),m=n(8),h=n(13),w=(n(22),n(23),n(9)),f=n.n(w),b=n(10),y=n(11),v=n.n(y),E=n(3);function x(t){return a.a.createElement("div",{className:"flexnowrap"},a.a.createElement("div",{className:"led led-".concat(t.color)}),a.a.createElement("div",null,t.text))}function g(t){return a.a.createElement("div",{id:"top"},a.a.createElement("a",{href:"https://github.com/cs01/termpair"},a.a.createElement("img",{height:"30px",src:f.a,alt:"logo"})))}function k(t){return a.a.createElement("div",{id:"statusbar"}," ",a.a.createElement("div",null,"connected"===t.status?a.a.createElement(x,{color:"green",text:t.status}):a.a.createElement(x,{color:"red",text:t.status})),a.a.createElement("div",null,t.terminalData.allow_browser_control&&"connected"===t.status?a.a.createElement(x,{color:"green",text:"can type"}):a.a.createElement(x,{color:"orange",text:"cannot type"})),a.a.createElement("div",null,t.terminalData.num_clients?t.terminalData.num_clients:"0"," ","Connected Clients"),a.a.createElement("div",null,"Started at"," ",v()(t.terminalData.broadcast_start_time_iso).format("h:mm:ss a on MMM Do YYYY")))}function j(){return a.a.createElement("div",{id:"bottom"},a.a.createElement("div",null,"A ",a.a.createElement("a",{href:"https://grassfedcode.com"},"Chad Smith")," project"),a.a.createElement("div",null,a.a.createElement("a",{href:"https://github.com/cs01"},"GitHub")),a.a.createElement("div",null,a.a.createElement("a",{href:"https://twitter.com/grassfedcode"},"Twitter")))}function O(t){t.writeln("To broadcast a terminal, run");var e="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.pathname);t.writeln(""),t.writeln('    pipx run termpair share --host "'.concat(e,'"')),t.writeln(""),t.writeln("Then open or share the url printed to the terminal."),t.writeln("To install pipx, see https://pipxproject.github.io/pipx/"),t.writeln("All terminal data is end-to-end encrypted \ud83d\udd12."),t.writeln("The termpair server and third parties can't read transmitted data.")}var _=function(t){function e(t){var n;Object(u.a)(this,e),n=Object(p.a)(this,Object(m.a)(e).call(this,t));var r=new URLSearchParams(window.location.search).get("terminal_id"),i=null!=window.crypto;n.state={terminalData:{},terminalId:r,hasCrypto:i,status:r&&i?"connection-pending":"disconnected",num_clients:null,secretEncryptionKey:"pending"},n.xterm=new b.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e3}),n.terminalRef=a.a.createRef();return n.xterm.resize(90,20),n}return Object(h.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(g,Object.assign({},this.props,this.state)),a.a.createElement("div",{id:"terminal",ref:this.terminalRef.current}),this.state.terminalId?a.a.createElement(k,Object.assign({},this.props,this.state)):null,a.a.createElement(j,null))}},{key:"componentDidMount",value:function(){var t=Object(l.a)(s.a.mark(function t(){var e,n,r,a,i,c,o,u=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Object(l.a)(s.a.mark(function t(r){var a,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("new_output"!==(a=JSON.parse(r.data)).event){t.next=9;break}return i=a.payload,t.next=5,Object(E.a)(n,i);case 5:c=t.sent,e.writeUtf8(c),t.next=10;break;case 9:"resize"===a.event?(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.resize(a.payload.cols,a.payload.rows)},500)):"num_clients"===a.event?this.setState({num_clients:a.payload}):console.error("unknown event type",a);case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)},c=function(t){return o.apply(this,arguments)},e=this.xterm,t.next=5,Object(E.c)();case 5:return n=t.sent,this.setState({secretEncryptionKey:n}),t.next=9,fetch("terminal/".concat(this.state.terminalId));case 9:return t.next=11,t.sent.json();case 11:if(r=t.sent,this.setState({terminalData:r}),e.open(document.getElementById("terminal")),e.writeln("Welcome to TermPair! https://github.com/cs01/termpair"),e.writeln(""),r.terminal_id){t.next=21;break}return O(e),t.abrupt("return");case 21:if(n){t.next=26;break}return O(e),t.abrupt("return");case 26:if(this.state.hasCrypto){t.next=30;break}return e.writeln("TermPair only works on secure connections."),O(e),t.abrupt("return");case 30:a="https:"===window.location.protocol?"wss":"ws",i=new WebSocket("".concat(a,"://").concat(window.location.hostname,":").concat(window.location.port).concat(window.location.pathname,"connect_browser_to_terminal?terminal_id=").concat(this.state.terminalId)),e.onKey(function(){var t=Object(l.a)(s.a.mark(function t(e,r){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i,t.next=3,Object(E.b)(n,e.key);case 3:t.t1=t.sent,t.t0.send.call(t.t0,t.t1);case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),i.addEventListener("open",function(t){u.setState({status:"connected"}),e.writeln("Connection established with end-to-end encryption \ud83d\udd12."),e.writeln("The termpair server and third parties can't read transmitted data.")}),i.addEventListener("close",function(t){"connected"===u.state.status?e.writeln("Connection ended"):e.writeln("Failed to establish connection. Ensure you have a valid url."),O(e),u.setState({status:"disconnected"}),u.setState({num_clients:0})}),i.addEventListener("message",c.bind(this));case 36:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(r.Component);c.a.render(a.a.createElement(_,null),document.getElementById("root"))},9:function(t,e,n){t.exports=n.p+"static/media/logo.74cdedb8.png"}},[[14,1,2]]]);
//# sourceMappingURL=main.c8e99a3e.chunk.js.map