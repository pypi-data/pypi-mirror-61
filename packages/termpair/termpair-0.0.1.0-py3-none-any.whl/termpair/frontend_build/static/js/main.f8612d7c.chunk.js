(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return o}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return p});var r=n(1),a=n.n(r),i=n(5),c=12;function o(){return s.apply(this,arguments)}function s(){return(s=Object(i.a)(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=window.location.hash.substring(1,window.location.hash.length-1),r=e.from(n,"base64"),t.next=5,window.crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 5:return t.abrupt("return",t.sent);case 8:return t.prev=8,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 12:case"end":return t.stop()}},t,null,[[0,8]])}))).apply(this,arguments)}function l(e,t){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(a.a.mark(function t(n,r){var i,o,s,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.from(r,"base64"),o=i.subarray(0,c),s=i.subarray(c),t.t0=e,t.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},n,s);case 6:return t.t1=t.sent,l=t.t0.from.call(t.t0,t.t1).toString("utf-8"),t.abrupt("return",l);case 9:case"end":return t.stop()}},t)}))).apply(this,arguments)}function p(e,t){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(a.a.mark(function e(t,n){var r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=window.crypto.getRandomValues(new Uint8Array(c)),e.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},t,(new TextEncoder).encode(n));case 3:return i=e.sent,o=m(r,i),s=h(o),e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function h(e){for(var t=new Uint8Array(e),n="",r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}}).call(this,n(84).Buffer)},33:function(e,t,n){e.exports=n.p+"static/media/logo.74cdedb8.png"},38:function(e,t,n){e.exports=n(89)},43:function(e,t,n){},46:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(29),c=n.n(i),o=(n(43),n(1)),s=n.n(o),l=n(5),u=n(30),p=n(31),d=n(36),m=n(32),h=n(37),w=(n(46),n(33)),f=n.n(w),b=n(34),v=n(35),y=n.n(v),E=n(12);function g(e){return a.a.createElement("div",{className:"flexnowrap"},a.a.createElement("div",{className:"led led-".concat(e.color)}),a.a.createElement("div",null,e.text))}function x(){return a.a.createElement("div",{id:"bottom"},a.a.createElement("div",null,"A ",a.a.createElement("a",{href:"https://grassfedcode.com"},"Chad Smith")," project"),a.a.createElement("div",null,a.a.createElement("a",{href:"https://github.com/cs01"},"GitHub")),a.a.createElement("div",null,a.a.createElement("a",{href:"https://twitter.com/grassfedcode"},"Twitter")))}function _(e){return a.a.createElement("div",{id:"top"},a.a.createElement("a",{href:"https://github.com/cs01/termpair"},a.a.createElement("img",{height:"30px",src:f.a,alt:"logo"})))}function k(e){return a.a.createElement("div",{id:"statusbar"}," ",a.a.createElement("div",null,"connected"===e.status?a.a.createElement(g,{color:"green",text:e.status}):a.a.createElement(g,{color:"red",text:e.status})),a.a.createElement("div",null,e.allow_browser_control?a.a.createElement(g,{color:"green",text:"can type"}):a.a.createElement(g,{color:"orange",text:"cannot type"})),a.a.createElement("div",null,e.num_clients?e.num_clients:"0"," Connected Clients"),a.a.createElement("div",null,"Started at"," ",y()(e.broadcast_start_time_iso).format("h:mm:ss a on MMM Do YYYY")))}function O(e){return a.a.createElement("div",{id:"terminal",className:e.status,ref:e.terminalRef.current})}function j(e){var t="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.pathname);return a.a.createElement("div",{id:"terminal-entry"},a.a.createElement("p",null,e.error),a.a.createElement("p",null,"To broadcast a terminal, run"),a.a.createElement("pre",null,"pipx run termpair==",e.termpair_version,' share --host "',t,'"'),a.a.createElement("p",null,"then open the link printed to the terminal."))}var S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={status:e.terminal_id&&null!=window.crypto?"connection-pending":"disconnected",num_clients:n.props.num_clients,terminal_id:n.props.terminal_id,secretEncryptionKey:"pending"},n.xterm=new b.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e3}),n.terminalRef=a.a.createRef(),n.xterm.resize(e.cols||60,e.rows||20),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e;return e=null!=window.crypto?this.state.terminal_id?null==this.state.secretEncryptionKey?a.a.createElement(j,Object.assign({},this.props,{error:"Encryption key is invalid or missing"})):a.a.createElement(O,Object.assign({},this.props,{terminalRef:this.terminalRef})):a.a.createElement(j,Object.assign({},this.props,{error:"Valid terminal id not provided."})):a.a.createElement(j,Object.assign({error:"This domain is not secure and thus cannot perform in-browser encryption/decryption."},this.props)),a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(_,Object.assign({},this.props,this.state)),e,a.a.createElement(k,Object.assign({},this.props,this.state)),a.a.createElement(x,null))}},{key:"componentDidMount",value:function(){var e=Object(l.a)(s.a.mark(function e(){var t,n,r,a,i,c,o=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=function(){return(c=Object(l.a)(s.a.mark(function e(r){var a,i,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("new_output"!==(a=JSON.parse(r.data)).event){e.next=9;break}return i=a.payload,e.next=5,Object(E.a)(t,i);case 5:c=e.sent,n.write(c),e.next=10;break;case 9:"resize"===a.event?(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){n.resize(a.payload.cols,a.payload.rows)},500)):"num_clients"===a.event?this.setState({num_clients:a.payload}):console.error("unknown event type",a);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)},i=function(e){return c.apply(this,arguments)},this.state.terminal_id){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Object(E.c)();case 6:if(t=e.sent,this.setState({secretEncryptionKey:t}),(n=this.xterm).open(document.getElementById("terminal")),n.writeln("Welcome to TermPair! https://github.com/cs01/termpair"),this.state.terminal_id&&t){e.next=18;break}return n.writeln(""),n.writeln("A valid terminal id and e2ee key must be provided."),n.writeln("To view or broadcast a terminal, see instructions at"),n.writeln("https://github.com/cs01/termpair"),this.setState({status:"disconnected"}),e.abrupt("return");case 18:r="https:"===window.location.protocol?"wss":"ws",a=new WebSocket("".concat(r,"://").concat(window.location.hostname,":").concat(window.location.port).concat(window.location.pathname,"connect_browser_to_terminal?terminal_id=").concat(this.state.terminal_id)),n.on("key",function(){var e=Object(l.a)(s.a.mark(function e(n,r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,Object(E.b)(t,n);case 3:e.t1=e.sent,e.t0.send.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),a.addEventListener("open",function(e){o.setState({status:"connected"}),n.writeln("Connection established with end-to-end encryption,"),n.writeln("which means the termpair server and third parties can't read transmitted data.")}),a.addEventListener("close",function(e){"connected"===o.state.status?n.writeln("Connection ended"):(n.writeln("Failed to establish connection. Ensure you have a valid url."),n.writeln("To view or broadcast a terminal, see instructions at"),n.writeln("https://github.com/cs01/termpair")),o.setState({status:"disconnected"}),o.setState({num_clients:0})}),a.addEventListener("message",i.bind(this));case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(r.Component);c.a.render(a.a.createElement(S,window.initial_data),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.f8612d7c.chunk.js.map