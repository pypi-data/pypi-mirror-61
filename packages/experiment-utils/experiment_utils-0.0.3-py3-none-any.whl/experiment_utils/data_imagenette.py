# AUTOGENERATED! DO NOT EDIT! File to edit: nbs/03_data_imagenette.ipynb (unless otherwise specified).

__all__ = ['get_data']

# Cell
# hide
from fastai.basics import *
from fastai.vision import *

# Cell
# taken from fastai exampes
def get_data(size=128, woof:int=1, bs=64, augm = 'min', workers=None, v2=True, **kwargs):

    path = URLs.IMAGEWOOF     if woof else URLs.IMAGENETTE
    path = untar_data(path)

    tfms_list = { 'min': ([flip_lr(p=0.5)], []),
                  'def': (get_transforms()[0], []),
                  'no': ([], [])
                }
    tfms = tfms_list[augm]
    databunch = (ImageList.from_folder(path).split_by_folder(valid='val')
            .label_from_folder().transform(tfms, size=size)
            .databunch(bs=bs)) # , num_workers=workers)

    data = databunch.presize(size, scale=(0.35,1)).normalize(imagenet_stats)
    return data