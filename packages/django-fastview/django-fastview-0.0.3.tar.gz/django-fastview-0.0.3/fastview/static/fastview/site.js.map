{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./static_src/Formset.js","webpack:///./static_src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Form","formset","rootEl","prefix","this","deleteEl","getDeleteEl","deleteCon","getDeleteCon","render","checkbox","querySelector","onchange","checked","deleted","undeleted","parentNode","deletedForm","addedForm","canDelete","style","removeProperty","setProperty","Formset","totalFormsEl","document","getElementById","initialForms","numFormsMin","parseInt","numFormsMax","nextId","numForms","formEls","querySelectorAll","dataForm","forms","forEach","formEl","formPrefix","getAttribute","form","formClass","push","template","dataTemplate","templatePrefix","addEl","getAddEl","addCon","getAddCon","button","createElement","innerHTML","type","appendChild","onclick","addForm","id","formRoot","createForm","newForm","insertForm","formsetChanged","canAdd","formHtml","replace","cloneNode","removeAttribute","lastForm","length","insertBefore","nextSibling","newPrefix","addEventListener","event","dataFormset","formsetClass","rootEls","formsets"],"mappings":"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","file":"site.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/fastview/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * Formset management\n */\n\nconst defaultDataFormset = 'fastview-formset';\nconst defaultDataForm = 'fastview-formset-form';\nconst defaultDataTemplate = 'fastview-formset-template';\n\n\nclass Form {\n  /**\n   * Track forms within a formset\n   */\n  constructor(formset, rootEl, prefix) {\n    this.formset = formset;\n    this.rootEl = rootEl;\n    this.prefix = prefix;\n\n    this.deleteEl = this.getDeleteEl();\n    this.deleteCon = this.getDeleteCon();\n    this.render();\n  }\n\n  getDeleteEl() {\n    let checkbox = this.rootEl.querySelector(`[name=\"${this.prefix}-DELETE\"]`);\n    if (!checkbox) {\n      return;\n    }\n    checkbox.onchange = () => {\n      if (checkbox.checked) {\n        this.deleted();\n      } else {\n        this.undeleted();\n      }\n    };\n    return checkbox\n  }\n\n  getDeleteCon() {\n    if (!this.deleteEl) {\n      return;\n    }\n    return this.deleteEl.parentNode;\n  }\n\n  get isDeleted() {\n    return this.deleteEl.checked;\n  }\n\n  deleted() {\n    this.formset.deletedForm(this);\n  }\n\n  undeleted() {\n    this.formset.addedForm(this);\n  }\n\n  formsetChanged() {\n    this.render();\n  }\n\n  render() {\n    /**\n     * Render the form whenever there is a change to delete state\n     *\n     * Hides and shows the delete field\n     */\n    if (!this.deleteCon) {\n      return;\n    }\n    if (this.formset.canDelete) {\n      this.deleteCon.style.removeProperty('display');\n    } else {\n      this.deleteCon.style.setProperty('display', 'none');\n    }\n  }\n}\n\nexport class Formset {\n  /**\n   * Manage a formset\n   */\n\n  dataForm = defaultDataForm;\n  dataTemplate = defaultDataTemplate;\n  formClass = Form;\n\n  constructor(rootEl, prefix) {\n    this.rootEl = rootEl;\n    this.prefix = prefix;\n\n    // Find management form\n    this.totalFormsEl = document.getElementById(`id_${prefix}-TOTAL_FORMS`);\n    this.initialForms = document.getElementById(`id_${prefix}-INITIAL_FORMS`);\n    this.numFormsMin = parseInt(document.getElementById(`id_${prefix}-MIN_NUM_FORMS`).value, 10);\n    this.numFormsMax = parseInt(document.getElementById(`id_${prefix}-MAX_NUM_FORMS`).value, 10);\n\n    this.nextId = this.numForms + 1;\n\n    // Find existing forms\n    let formEls = rootEl.querySelectorAll(`[data-${this.dataForm}]`);\n    this.forms = []\n    formEls.forEach(formEl => {\n      let formPrefix = formEl.getAttribute(`data-${this.dataForm}`);\n      let form = new this.formClass(this, formEl, formPrefix);\n      this.forms.push(form);\n    });\n\n    // Find template form\n    this.template = rootEl.querySelector(`[data-${this.dataTemplate}]`);\n    this.templatePrefix = this.template.getAttribute(`data-${this.dataTemplate}`);\n\n    // Find add button\n    this.addEl = this.getAddEl();\n    this.addCon = this.getAddCon();\n\n    // Re-render this and all forms\n    this.render();\n  }\n\n  getAddEl() {\n    let button = document.createElement('button');\n    button.innerHTML = 'Add';\n    button.type = 'button';\n    this.rootEl.appendChild(button);\n    button.onclick = () => {\n      this.addForm();\n    }\n    return button;\n  }\n\n  getAddCon() {\n    return this.addEl;\n  }\n\n  addForm() {\n    /**\n     * Create and insert a new form, and let all forms know the formset has changed\n     */\n    // Get new form ID\n    let id = this.nextId;\n\n    // Create and insert\n    let formRoot = this.createForm(id);\n    let newForm = this.insertForm(id, formRoot);\n\n    // Notify handlers\n    this.addedForm(newForm);\n  }\n\n  render() {\n    /**\n     * Re-render formset and forms\n     */\n    this.forms.forEach(form => {\n      form.formsetChanged();\n    });\n\n    if (this.canAdd) {\n      this.addCon.style.removeProperty('display');\n    } else {\n      this.addCon.style.setProperty('display', 'none');\n    }\n  }\n\n  get numForms() {\n    return parseInt(this.totalFormsEl.value, 10)\n  }\n\n  set numForms(value) {\n    this.totalFormsEl.value = value;\n  }\n\n  createForm(id) {\n    /**\n     * Create a new form\n     */\n    // Clone template, replacing __prefix__\n    let template = this.template.innerHTML;\n    let formHtml = template.replace(/__prefix__/g, id);\n    let formRoot = this.template.cloneNode();\n    formRoot.removeAttribute(\"style\");\n    formRoot.innerHTML = formHtml;\n\n    return formRoot\n  }\n\n  insertForm(id,formRoot) {\n    /**\n     * Insert the new form into the formset\n     */\n    // Add to the end of the existing forms, or after the template if no forms yet\n    let lastForm = this.template;\n    if (this.forms.length > 0) {\n      lastForm = this.forms[this.forms.length - 1].rootEl;\n    }\n    lastForm.parentNode.insertBefore(formRoot, lastForm.nextSibling);\n\n    // Register form\n    let newPrefix = this.templatePrefix.replace('__prefix__', id)\n    let form = new Form(this, formRoot, newPrefix)\n    this.forms.push(form);\n    return form;\n  }\n\n  addedForm(form) {\n    /**\n     * Called when the form has been added to the formset\n     *\n     * Hides and shows the add button\n     */\n    this.numForms += 1\n    this.render();\n  }\n\n  deletedForm(form) {\n    this.numForms -= 1\n    this.render();\n  }\n\n  get canAdd() {\n    /**\n     * Can add if the limit has not been reached\n     */\n    return this.numForms < this.numFormsMax;\n  }\n\n  get canDelete() {\n    /**\n     * Can delete if there are more than the minimum number\n     */\n    return this.numForms > this.numFormsMin;\n  }\n}\n\nexport function formsets(\n  dataFormset = defaultDataFormset,\n  formsetClass = Formset,\n) {\n  /**\n   * Initialise formsets with the data attribute matching dataFormset\n   */\n  let rootEls = document.querySelectorAll(`[data-${dataFormset}]`);\n  rootEls.forEach(rootEl => {\n    let prefix = rootEl.getAttribute(`data-${dataFormset}`);\n    new formsetClass(rootEl, prefix);\n  });\n}\n","import { formsets } from './Formset.js';\n\ndocument.addEventListener('DOMContentLoaded', (event) => {\n  formsets();\n})\n"],"sourceRoot":""}