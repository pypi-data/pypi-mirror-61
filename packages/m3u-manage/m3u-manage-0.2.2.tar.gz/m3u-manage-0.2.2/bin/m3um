#!/usr/bin/env python

import sys
sys.path.insert(0, '.')

import click
import m3u_manage


@click.group()
def cli():
    pass

@click.command('analyze', short_help='Analyze directory.')
@click.argument('directory', required=True)
def do_analyze(directory):
    m3u_manage.analyze(directory)

@click.command('generate', short_help='Generate data.')
@click.option('--config', required=True, help='Configuration filename.')
def do_generate(config):
    m3u_manage.generate(config)

@click.command('mesh', short_help='Mesh playlists.')
@click.option('--outfile', '-o', required=True, help='New playlist file to create.')
@click.argument('filenames', nargs=-1, required=True)
def do_mesh(filenames, outfile):
    m3u_manage.mesh(filenames, outfile)

cli.add_command(do_generate)
cli.add_command(do_analyze)
cli.add_command(do_mesh)

if __name__ == '__main__':
    from m3u_manage.__meta__ import __version__
    print("m3u-manage {}".format(__version__))
    cli()
